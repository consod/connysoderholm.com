<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Save an Excel sheet as pdf with Python and win32 - connysoderholm.com</title><meta name="description" content="Saving an Excel sheet to Pdf with Python Saving a finished report or table in Excel is easy. You choose SaveAs and save the sheet as Pdf. Doing this automatically with Python is a bit trickier though. In this post, we will take a closer&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://consod.github.io/connysoderholm.com/save-an-excel-sheet-as-pdf-with-python-and-win32/"><link rel="alternate" type="application/atom+xml" href="https://consod.github.io/connysoderholm.com/feed.xml"><link rel="alternate" type="application/json" href="https://consod.github.io/connysoderholm.com/feed.json"><meta property="og:title" content="Save an Excel sheet as pdf with Python and win32"><meta property="og:site_name" content="connysoderholm.com"><meta property="og:description" content="Saving an Excel sheet to Pdf with Python Saving a finished report or table in Excel is easy. You choose SaveAs and save the sheet as Pdf. Doing this automatically with Python is a bit trickier though. In this post, we will take a closer&hellip;"><meta property="og:url" content="https://consod.github.io/connysoderholm.com/save-an-excel-sheet-as-pdf-with-python-and-win32/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://consod.github.io/connysoderholm.com/assets/css/style.css?v=7481e241a067a533a35b659302b5203e"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://consod.github.io/connysoderholm.com/save-an-excel-sheet-as-pdf-with-python-and-win32/"},"headline":"Save an Excel sheet as pdf with Python and win32","datePublished":"2019-12-15T23:48","dateModified":"2023-05-03T21:57","description":"Saving an Excel sheet to Pdf with Python Saving a finished report or table in Excel is easy. You choose SaveAs and save the sheet as Pdf. Doing this automatically with Python is a bit trickier though. In this post, we will take a closer&hellip;","author":{"@type":"Person","name":"Conny Söderholm","url":"https://consod.github.io/connysoderholm.com/authors/conny-soederholm/"},"publisher":{"@type":"Organization","name":"Conny Söderholm"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><div class="top__inner" id="js-post__progress"><a class="logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a></div></header><main class="main"><article class="post post--sidebar-left"><header class="post__header"><h1 class="post__title">Save an Excel sheet as pdf with Python and win32</h1><div class="metadata"><a href="https://consod.github.io/connysoderholm.com/tags/excel/" class="metadata__maintag">Excel</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2019-12-15T23:48" class="metadata__date">15.12.2019</time><div class="metadata__update">(Updated on <time datetime="2023-05-03T21:57">03.05.2023 </time>)</div></div></header><div class="post__entry"><h1>Saving an Excel sheet to Pdf with Python</h1><p>Saving a finished report or table in Excel is easy. You choose SaveAs and save the sheet as Pdf. Doing this automatically with Python is a bit trickier though. In this post, we will take a closer look on how to do this with the win32 library. The full code is available at the bottom of the post. Note that you need Excel installed in order to run this script successfully.</p><h2>Installing dependencies</h2><p>install the win32 library first with: <code class="EnlighterJSRAW" data-enlighter-language="generic">pip install pypiwin32</code>. This will install the Win32 Api library, which according to <a href="https://pypi.org/project/pypiwin32/219/">PyPi </a>contains: <em>Python extensions for Microsoft Windows Provides access to much of the Win32 API, the ability to create and use COM objects, and the Pythonwin environment.</em></p><h2>File paths</h2><p>To get the file paths we use pathlib. Pathlib was introduced in Python 3.4 so it is quite new (Using Python 3.8 during the writing of this article). We specify the name of the Excel workbook we want to make a pdf of, and also the output pdf's name.</p><p><code class="EnlighterJSRAW" data-enlighter-language="python">excel_file = "pdf_me.xlsx"</code> <code class="EnlighterJSRAW" data-enlighter-language="python">pdf_file = "pdf_me.pdf"</code></p><p>We then create paths from our current working directory (cwd) with Pathlibs cwd() method.</p><p><code class="EnlighterJSRAW" data-enlighter-language="python">excel_path = str(pathlib.Path.cwd() / excel_file)</code> <code class="EnlighterJSRAW" data-enlighter-language="python">pdf_path = str(pathlib.Path.cwd() / pdf_file)</code></p><h2>Firing up Excel</h2><p>Excel is next up. We start the Excel application and hide it.</p><p><code class="EnlighterJSRAW" data-enlighter-language="python">excel = client.DispatchEx("Excel.Application")</code> <code class="EnlighterJSRAW" data-enlighter-language="python">excel.Visible = 0</code></p><p>We then open our workbook&nbsp; <code class="EnlighterJSRAW" data-enlighter-language="python">wb = excel.Workbooks.Open(excel_path)</code> and load our first sheet with <code class="EnlighterJSRAW" data-enlighter-language="python">ws = wb.Worksheets[1]</code></p><p>Now it is time to use the SaveAs to save our sheet as a pdf. <code class="EnlighterJSRAW" data-enlighter-language="python">wb.SaveAs(pdf_path, FileFormat=57)</code>Fileformat 57 is the pdf file format.</p><p>We then close our workbook and quit our Excel application. Our pdf is now saved in our working directory.</p><h2>The code</h2><pre class="EnlighterJSRAW" data-enlighter-language="python">from win32com import client<restore-line-break>import win32api<restore-line-break>import pathlib<restore-line-break><restore-line-break>### pip install pypiwin32 if module not found<restore-line-break><restore-line-break>excel_file = "pdf_me.xlsx"<restore-line-break>pdf_file = "pdf_me.pdf"<restore-line-break>excel_path = str(pathlib.Path.cwd() / excel_file)<restore-line-break>pdf_path = str(pathlib.Path.cwd() / pdf_file)<restore-line-break><restore-line-break>excel = client.DispatchEx("Excel.Application")<restore-line-break>excel.Visible = 0<restore-line-break><restore-line-break>wb = excel.Workbooks.Open(excel_path)<restore-line-break>ws = wb.Worksheets[1]<restore-line-break><restore-line-break>try:<restore-line-break>    wb.SaveAs(pdf_path, FileFormat=57)<restore-line-break>except Exception as e:<restore-line-break>    print("Failed to convert")<restore-line-break>    print(str(e))<restore-line-break>finally:<restore-line-break>    wb.Close()<restore-line-break>    excel.Quit()</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre><p>&nbsp;</p></div><aside class="post__sidebar post__sidebar--left"><div class="sidebar sidebar--sticky"><section class="sidebar__item"><h3 class="sidebar__title">Share on:</h3><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsave-an-excel-sheet-as-pdf-with-python-and-win32%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer">Facebook </a><a href="https://twitter.com/share?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsave-an-excel-sheet-as-pdf-with-python-and-win32%2F&amp;via=connysoderholm.com&amp;text=Save%20an%20Excel%20sheet%20as%20pdf%20with%20Python%20and%20win32" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer">Twitter </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsave-an-excel-sheet-as-pdf-with-python-and-win32%2F&amp;media=undefined&amp;description=Save%20an%20Excel%20sheet%20as%20pdf%20with%20Python%20and%20win32" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer">Pinterest </a><a href="https://mix.com/add?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsave-an-excel-sheet-as-pdf-with-python-and-win32%2F" class="js-share mix" title="Share with Mix" rel="nofollow noopener noreferrer">Mix </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsave-an-excel-sheet-as-pdf-with-python-and-win32%2F" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer">LinkedIn </a><a href="https://buffer.com/add?text=Save%20an%20Excel%20sheet%20as%20pdf%20with%20Python%20and%20win32&amp;url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsave-an-excel-sheet-as-pdf-with-python-and-win32%2F" class="js-share buffer" title="Share with Buffer" rel="nofollow noopener noreferrer">Buffer </a><a href="https://api.whatsapp.com/send?text=Save%20an%20Excel%20sheet%20as%20pdf%20with%20Python%20and%20win32 https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsave-an-excel-sheet-as-pdf-with-python-and-win32%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer">WhatsApp</a></div></section><section class="sidebar__item"><h3 class="sidebar__title">Tagged in:</h3><div class="post__tag"><ul><li><a href="https://consod.github.io/connysoderholm.com/tags/excel/" title="Excel">Excel</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/pdf/" title="pdf">pdf</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/pypiwin32/" title="pypiwin32">pypiwin32</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/python/" title="Python">Python</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/win32api/" title="win32api">win32api</a></li></ul></div></section><nav class="sidebar__item post__nav"><div class="post__nav__prev"><h3 class="sidebar__title">Previous post:</h3><a href="https://consod.github.io/connysoderholm.com/splitting-a-pdf-to-single-pages-with-pypdf2/" rel="next">Splitting a pdf to single pages with PyPDF2</a></div><div class="post__nav__next"><h3 class="sidebar__title">Next post:</h3><a href="https://consod.github.io/connysoderholm.com/copy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl/" rel="next">Copy data from one Excel workbook to a new workbook with Python &amp; OpenPyXL</a></div></nav></div></aside><footer class="post__footer"><div class="post__author"><div><h3 class="h6"><a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" rel="author">Conny Söderholm</a></h3></div></div></footer></article><div class="post__related"><h3>Related post</h3><div class="l-grid"><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/creating-a-simple-file-dialog-box-with-tkinter/">Creating a simple file dialog box with Tkinter</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/file-dialog/" class="metadata__maintag">File Dialog</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-14T20:47" class="metadata__date">14.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-do-you-copy-an-excel-2016-formula-without-changing-the-cell-references/">How do you copy an Excel 2016 formula without changing the cell references?</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/copying/" class="metadata__maintag">Copying</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-13T21:58" class="metadata__date">13.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-to-reference-cells-and-sheets-indirectly-in-excel-2016/">How to Reference cells and sheets indirectly in Excel 2016</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/address/" class="metadata__maintag">ADDRESS</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-08T23:38" class="metadata__date">08.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/saying-hello-world-with-tkinter/">Saying Hello World with tkinter</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/gui/" class="metadata__maintag">GUI</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-04T21:06" class="metadata__date">04.06.2018</time></div></div></article></div></div></main><footer class="footer"><div class="footer__top"><a class="logo footer__logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a></div><div class="footer__bottom"><div class="footer__copyright"></div></div></footer></div><script defer="defer" src="https://consod.github.io/connysoderholm.com/assets/js/scripts.min.js?v=01200278524b74ccf3210b7882b81e59"></script><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script>var images = document.querySelectorAll('img[loading]');
      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
            images[i].classList.add('is-loaded');
            images[i].parentNode.classList.remove('is-img-loading');
            images[i].parentNode.parentNode.classList.remove('is-img-loading');
         } else {
            images[i].addEventListener('load', function () {
               this.classList.add('is-loaded');
               this.parentNode.classList.remove('is-img-loading');
               this.parentNode.parentNode.classList.remove('is-img-loading');
            }, false);
         }
      }</script></body></html>