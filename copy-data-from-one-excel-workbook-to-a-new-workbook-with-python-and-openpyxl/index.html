<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Copy data from one Excel workbook to a new workbook with Python &amp; OpenPyXL - connysoderholm.com</title><meta name="description" content="I got an excellent question in my OpenPyXL course. The question was how to transfer data from one Excel workbook to another with OpenPyXL. Transferring data only is easier, as there is no need to worry about the formatting of cells and sheets. The complete&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://consod.github.io/connysoderholm.com/copy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl/"><link rel="alternate" type="application/atom+xml" href="https://consod.github.io/connysoderholm.com/feed.xml"><link rel="alternate" type="application/json" href="https://consod.github.io/connysoderholm.com/feed.json"><meta property="og:title" content="Copy data from one Excel workbook to a new workbook with Python & OpenPyXL"><meta property="og:site_name" content="connysoderholm.com"><meta property="og:description" content="I got an excellent question in my OpenPyXL course. The question was how to transfer data from one Excel workbook to another with OpenPyXL. Transferring data only is easier, as there is no need to worry about the formatting of cells and sheets. The complete&hellip;"><meta property="og:url" content="https://consod.github.io/connysoderholm.com/copy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://consod.github.io/connysoderholm.com/assets/css/style.css?v=7481e241a067a533a35b659302b5203e"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://consod.github.io/connysoderholm.com/copy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl/"},"headline":"Copy data from one Excel workbook to a new workbook with Python & OpenPyXL","datePublished":"2019-12-16T22:19","dateModified":"2023-05-03T21:57","description":"I got an excellent question in my OpenPyXL course. The question was how to transfer data from one Excel workbook to another with OpenPyXL. Transferring data only is easier, as there is no need to worry about the formatting of cells and sheets. The complete&hellip;","author":{"@type":"Person","name":"Conny Söderholm","url":"https://consod.github.io/connysoderholm.com/authors/conny-soederholm/"},"publisher":{"@type":"Organization","name":"Conny Söderholm"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><div class="top__inner" id="js-post__progress"><a class="logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle__box"><span class="navbar__toggle__inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://consod.github.io/connysoderholm.com/about-me/" target="_self">About me</a></li></ul></nav></div></header><main class="main"><article class="post post--sidebar-left"><header class="post__header"><h1 class="post__title">Copy data from one Excel workbook to a new workbook with Python &amp; OpenPyXL</h1><div class="metadata"><a href="https://consod.github.io/connysoderholm.com/tags/excel/" class="metadata__maintag">Excel</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2019-12-16T22:19" class="metadata__date">16.12.2019</time><div class="metadata__update">(Updated on <time datetime="2023-05-03T21:57">03.05.2023 </time>)</div></div></header><div class="post__entry"><p></p><p>I got an excellent question in my <a href="https://www.udemy.com/course/control-excel-with-python-openpyxl/l">OpenPyXL course</a>. The question was how to transfer data from one Excel workbook to another with OpenPyXL. Transferring data only is easier, as there is no need to worry about the formatting of cells and sheets. The complete code is available at the bottom of this post.</p><p></p><p></p><h2>Mission statement</h2><p></p><p></p><p>The question was how to copy data from one sheet in a workbook to several other sheets in a newly created workbook. The source workbook is WB1 with the source sheet WS1. The source sheet has 1000 rows of data. The data shall be copied to the new workbook WB2 and the sheets WS1 to WS10.</p><p></p><p></p><ul><li>Copy the first 100 rows data and paste it into sheet WS1</li><li>Copy the next 200 rows data and paste it into sheet WS2</li><li>Copy the next 50 rows data and paste it into sheet WS3</li><li>Copy the next 300 rows data and paste it into sheet WS4</li><li>Copy the next 350 rows data and paste it into sheet WS4</li></ul><p></p><p></p><h2>Imports and loading workbook</h2><p></p><p></p><p>To copy the values we need to import <code>Workbook</code> and <code>load_workbook</code> from the OpenPyXL library. We can now load our existing workbook, WB1. <code>WB1 = load_workbook("Source.xlsx", data_only=True)</code>. The next thing we need to do is set which sheet we are going to copy the data from. We name the sheet WB1_WS1 <code>WB1_WS1 = WB1["WS1"]</code>. After that we are ready to create a new workbook with <code>WB2 = Workbook()</code>. Notice the brackets for the method.</p><p></p><p></p><h2>Creating sheets</h2><p></p><p></p><p>The question stated that 10 sheets should be created, with the names WS1 to WS10. We can create the sheets with a for loop. Each sheet is created with <code>create_sheet(f"WS{i}")</code>. Notice the usage of <a href="https://realpython.com/python-f-strings/">Pythons f-string</a>. We then remove the default created sheet, Sheet1. We could also of course have renamed it.</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="python" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group=""># Create WB2 sheets WS1-WS10<restore-line-break>for i in range(1, 11):<restore-line-break>    WB2.create_sheet(f"WS{i}")<restore-line-break><restore-line-break># delete first sheet<restore-line-break>WB2.remove(WB2.worksheets[0])</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre><p></p><p></p><h2>Copy preparations</h2><p></p><p></p><p>The next thing is to create a list for holding our copy ranges, and also which sheets we want to copy the data to. The<code>copy_ranges</code> list holds how many rows we need to copy from the source sheet to the sheets defined in <code>copy_to_sheets</code>.</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="python" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group=""># Define the copy ranges and sheets<restore-line-break>copy_ranges = [100, 200, 50, 300, 350]<restore-line-break>copy_to_sheets = ["WS1", "WS2", "WS3", "WS4", "WS4"]</restore-line-break></restore-line-break></pre><p></p><p></p><h2>Copying the data</h2><p></p><p></p><p>We start with a for loop, that iterates through the <code>copy_ranges</code> list. <code>for i in range( len(copy_ranges)):</code>We then specify which sheet is in turn for copying <code>ws = WB2[ copy_to_sheets[i] ]</code>. Notice how we specify the sheet with the <code>copy_to_sheets</code> list. When <code>i</code> is 1 we select <code>WS1</code> and so on. We also initialize our <code>row_offset</code> to 1 so that we can keep track of which rows to copy next. We then set the row_offset with yet another for loop. We increase the offset <code>i</code> times with the corresponding values from <code>copy_ranges</code>.</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">for s in range(i):<restore-line-break>    offset += copy_ranges[s]</restore-line-break></pre><p></p><p></p><p>Now it is time to fill our sheets with data! we traverse through our offset range with a for loop and set the values of the corresponding sheet. First we get the row with <code>for j in range(offset, offset + copy_ranges[i]):</code>. Next up are the cells in each row:</p><p></p><p></p><p><code>for row in WB1_WS1.iter_rows(min_row=j, max_row=j, min_col=1, max_col=WB1_WS1.max_column):</code>.</p><p></p><p></p><p>We get the values for <code>values_row</code> with a list comprehension <code>[cell.value for cell in row]</code>. Finally, we append the row to the sheet with <code>ws.append(values_row)</code>.</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group=""># Copy the row with the help of iter_rows, append the row<restore-line-break>for j in range(offset,  offset + copy_ranges[i]):<restore-line-break>    #if j == 0:<restore-line-break>    #    continue<restore-line-break>    for row in WB1_WS1.iter_rows(min_row=j, max_row=j, min_col=1, max_col=WB1_WS1.max_column):<restore-line-break>        values_row = [cell.value for cell in row]<restore-line-break>    ws.append(values_row)</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre><p></p><p></p><p>To wrap up, we save the workbook: <code>WB2.save("WB2.xlsx")</code></p><p></p><p></p><p>That's it! Please comment below if you have questions or any feedback. See you later!</p><p></p><p></p><p>Use this link, <a href="https://www.udemy.com/course/control-excel-with-python-openpyxl/?couponCode=SAVEOPENPYXL">Control Excel with Python & OpenPyXL</a> or this code SAVEOPENPYXL to get the course for a discount on <a href="http://www.udemy.com">Udemy.com</a></p><p></p><p></p><figure class="wp-block-image"><img loading="lazy" src="https://consod.github.io/connysoderholm.com/media/posts/42/OpenPyXL_course-1024x407.png" alt="This image has an empty alt attribute; its file name is OpenPyXL_course-1024x407.png" sizes="(min-width: 1260px) calc(3.22vw + 703px), (min-width: 900px) calc(50.59vw + 116px), (min-width: 840px) calc(5vw + 684px), calc(85.58vw + 23px)" srcset="https://consod.github.io/connysoderholm.com/media/posts/42/responsive/OpenPyXL_course-1024x407-xs.png 320w, https://consod.github.io/connysoderholm.com/media/posts/42/responsive/OpenPyXL_course-1024x407-sm.png 480w, https://consod.github.io/connysoderholm.com/media/posts/42/responsive/OpenPyXL_course-1024x407-md.png 768w"></figure><p></p><p></p><h2>The code</h2><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">#!/usr/bin/python<restore-line-break># -*- coding: utf-8 -*-<restore-line-break><restore-line-break>"""<restore-line-break>Could you please suggest  how to copy the data from on work book to other book with specified rows<restore-line-break>Source: Excel work book "WB1" having work sheet "WS1", This sheet  having 1000 rows of data<restore-line-break>Destination: New work book 'WB2' and  work sheets WS1,WS2...WS10<restore-line-break>Could you please suggest the code for following condition:<restore-line-break>Copy the first 100 rows data and paste it WS1 sheet<restore-line-break>Copy the next 200 rows data and paste it WS2 sheet<restore-line-break>Copy the next 50 rows data and paste it WS3 sheet<restore-line-break>Copy the next 300 rows data and paste it WS4 sheet<restore-line-break>Copy the next 350 rows data and paste it WS4 sheet<restore-line-break>"""<restore-line-break><restore-line-break>from openpyxl import Workbook, load_workbook<restore-line-break><restore-line-break>WB1 = load_workbook("Source.xlsx", data_only=True)<restore-line-break>WB1_WS1 = WB1["WS1"]<restore-line-break>WB2 = Workbook()<restore-line-break><restore-line-break># Create WB2 sheets WS1-WS10<restore-line-break>for i in range(1, 11):<restore-line-break>    WB2.create_sheet(f"WS{i}")<restore-line-break><restore-line-break># delete first sheet<restore-line-break>WB2.remove(WB2.worksheets[0])<restore-line-break><restore-line-break># Define the copy ranges and sheets<restore-line-break>copy_ranges = [100, 200, 50, 300, 350]<restore-line-break>copy_to_sheets = ["WS1", "WS2", "WS3", "WS4", "WS4"]<restore-line-break><restore-line-break># Copy the values from the rows in WB1 to WB2.<restore-line-break>for i in range( len(copy_ranges)):<restore-line-break>    # Set the sheet to copy to<restore-line-break>    ws = WB2[ copy_to_sheets[i] ]<restore-line-break>    # Initialize row offset<restore-line-break>    offset = 1<restore-line-break>    # Set the row offset<restore-line-break>    for s in range(i):<restore-line-break>        offset += copy_ranges[s]<restore-line-break><restore-line-break>    # Copy the row with the help of iter_rows, append the row<restore-line-break>    for j in range(offset,  offset + copy_ranges[i]):<restore-line-break>        #if j == 0:<restore-line-break>        #    continue<restore-line-break>        for row in WB1_WS1.iter_rows(min_row=j, max_row=j, min_col=1, max_col=WB1_WS1.max_column):<restore-line-break>            values_row = [cell.value for cell in row]<restore-line-break>        ws.append(values_row)<restore-line-break><restore-line-break># Save the workbook<restore-line-break>WB2.save("WB2.xlsx")</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre><p></p></div><aside class="post__sidebar post__sidebar--left"><div class="sidebar sidebar--sticky"><section class="sidebar__item"><h3 class="sidebar__title">Share on:</h3><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcopy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer">Facebook </a><a href="https://twitter.com/share?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcopy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl%2F&amp;via=connysoderholm.com&amp;text=Copy%20data%20from%20one%20Excel%20workbook%20to%20a%20new%20workbook%20with%20Python%20%26%20OpenPyXL" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer">Twitter </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcopy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl%2F&amp;media=undefined&amp;description=Copy%20data%20from%20one%20Excel%20workbook%20to%20a%20new%20workbook%20with%20Python%20%26%20OpenPyXL" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer">Pinterest </a><a href="https://mix.com/add?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcopy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl%2F" class="js-share mix" title="Share with Mix" rel="nofollow noopener noreferrer">Mix </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcopy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl%2F" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer">LinkedIn </a><a href="https://buffer.com/add?text=Copy%20data%20from%20one%20Excel%20workbook%20to%20a%20new%20workbook%20with%20Python%20%26%20OpenPyXL&amp;url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcopy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl%2F" class="js-share buffer" title="Share with Buffer" rel="nofollow noopener noreferrer">Buffer </a><a href="https://api.whatsapp.com/send?text=Copy%20data%20from%20one%20Excel%20workbook%20to%20a%20new%20workbook%20with%20Python%20%26%20OpenPyXL https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcopy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer">WhatsApp</a></div></section><section class="sidebar__item"><h3 class="sidebar__title">Tagged in:</h3><div class="post__tag"><ul><li><a href="https://consod.github.io/connysoderholm.com/tags/excel/" title="Excel">Excel</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/openpyxl/" title="openpyxl">openpyxl</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/python/" title="Python">Python</a></li></ul></div></section><nav class="sidebar__item post__nav"><div class="post__nav__prev"><h3 class="sidebar__title">Previous post:</h3><a href="https://consod.github.io/connysoderholm.com/save-an-excel-sheet-as-pdf-with-python-and-win32/" rel="next">Save an Excel sheet as pdf with Python and win32</a></div><div class="post__nav__next"><h3 class="sidebar__title">Next post:</h3><a href="https://consod.github.io/connysoderholm.com/how-to-generate-an-xml-file-from-excel-with-python/" rel="next">How to generate an XML file from Excel with Python</a></div></nav></div></aside><footer class="post__footer"><div class="post__author"><div><h3 class="h6"><a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" rel="author">Conny Söderholm</a></h3></div></div></footer></article><div class="post__related"><h3>Related post</h3><div class="l-grid"><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/creating-a-simple-file-dialog-box-with-tkinter/">Creating a simple file dialog box with Tkinter</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/file-dialog/" class="metadata__maintag">File Dialog</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-14T20:47" class="metadata__date">14.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-do-you-copy-an-excel-2016-formula-without-changing-the-cell-references/">How do you copy an Excel 2016 formula without changing the cell references?</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/copying/" class="metadata__maintag">Copying</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-13T21:58" class="metadata__date">13.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-to-reference-cells-and-sheets-indirectly-in-excel-2016/">How to Reference cells and sheets indirectly in Excel 2016</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/address/" class="metadata__maintag">ADDRESS</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-08T23:38" class="metadata__date">08.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/saying-hello-world-with-tkinter/">Saying Hello World with tkinter</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/gui/" class="metadata__maintag">GUI</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-04T21:06" class="metadata__date">04.06.2018</time></div></div></article></div></div></main><footer class="footer"><div class="footer__top"><a class="logo footer__logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a></div><div class="footer__bottom"><div class="footer__copyright"></div></div></footer></div><script defer="defer" src="https://consod.github.io/connysoderholm.com/assets/js/scripts.min.js?v=01200278524b74ccf3210b7882b81e59"></script><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script>var images = document.querySelectorAll('img[loading]');
      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
            images[i].classList.add('is-loaded');
            images[i].parentNode.classList.remove('is-img-loading');
            images[i].parentNode.parentNode.classList.remove('is-img-loading');
         } else {
            images[i].addEventListener('load', function () {
               this.classList.add('is-loaded');
               this.parentNode.classList.remove('is-img-loading');
               this.parentNode.parentNode.classList.remove('is-img-loading');
            }, false);
         }
      }</script></body></html>