<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Creating and formatting a chart automatically in Excel with VBA - connysoderholm.com</title><meta name="description" content="Creating and formatting a chart automatically in Excel with VBAUsing Excel involves creating a lot of charts and tables. Most of the time, the operations are really simple but time consuming. Creating and formatting a chart takes time. In this post, we are exploring how we can create a chart automatically with some VBA code."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://consod.github.io/connysoderholm.com/creating-and-formatting-a-chart-automatically-in-excel-with-vba/"><link rel="alternate" type="application/atom+xml" href="https://consod.github.io/connysoderholm.com/feed.xml"><link rel="alternate" type="application/json" href="https://consod.github.io/connysoderholm.com/feed.json"><meta property="og:title" content="Creating and formatting a chart automatically in Excel with VBA"><meta property="og:site_name" content="connysoderholm.com"><meta property="og:description" content="Creating and formatting a chart automatically in Excel with VBAUsing Excel involves creating a lot of charts and tables. Most of the time, the operations are really simple but time consuming. Creating and formatting a chart takes time. In this post, we are exploring how we can create a chart automatically with some VBA code."><meta property="og:url" content="https://consod.github.io/connysoderholm.com/creating-and-formatting-a-chart-automatically-in-excel-with-vba/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://consod.github.io/connysoderholm.com/assets/css/style.css?v=7481e241a067a533a35b659302b5203e"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://consod.github.io/connysoderholm.com/creating-and-formatting-a-chart-automatically-in-excel-with-vba/"},"headline":"Creating and formatting a chart automatically in Excel with VBA","datePublished":"2018-07-03T22:07","dateModified":"2023-05-03T21:57","description":"Creating and formatting a chart automatically in Excel with VBAUsing Excel involves creating a lot of charts and tables. Most of the time, the operations are really simple but time consuming. Creating and formatting a chart takes time. In this post, we are exploring how we can create a chart automatically with some VBA code.","author":{"@type":"Person","name":"Conny Söderholm","url":"https://consod.github.io/connysoderholm.com/authors/conny-soederholm/"},"publisher":{"@type":"Organization","name":"Conny Söderholm"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><div class="top__inner" id="js-post__progress"><a class="logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle__box"><span class="navbar__toggle__inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://consod.github.io/connysoderholm.com/about-me/" target="_self">About me</a></li></ul></nav></div></header><main class="main"><article class="post post--sidebar-left"><header class="post__header"><h1 class="post__title">Creating and formatting a chart automatically in Excel with VBA</h1><div class="metadata"><a href="https://consod.github.io/connysoderholm.com/tags/chart/" class="metadata__maintag">chart</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-07-03T22:07" class="metadata__date">03.07.2018</time><div class="metadata__update">(Updated on <time datetime="2023-05-03T21:57">03.05.2023 </time>)</div></div></header><div class="post__entry"><h1>Creating and formatting a chart automatically in Excel with VBA</h1><p>Using Excel involves creating a lot of charts and tables. Most of the time, the operations are really simple but time consuming. Creating and formatting a chart takes time. In this post, we are exploring how we can create a chart automatically with some VBA code.</p><h2>The preparations and the result</h2><p>Start by creating some data labels and values in the range A1:B7. I created the labels "Load [%]" for the x-axis and "Fuel consumption [g/kWh]" for the y-axis. Press alt+F11 to go into the VBA editor. Write or paste the code below in the VBA editor. Go to the run macro and run the Creat_chart sub</p><h2>The code</h2><p>First, we are adding the chart to the active sheet. The chart is a Scatter with lines and with the style 2 formatting (241).  Next, we select the source data from the cells A1:B7 on the active sheet. You can format the axes with the MaximumScale and MinimumScale methods. The height and width are done with the With (pun intended).</p><p>We finish by setting the chart's title, x-axis title, and y-axis title. The axes titles are picked from the cells A1 and B1 where we had the text for the axes.</p><pre class="EnlighterJSRAW" data-enlighter-language="null">Sub Create_chart()<restore-line-break>    ' Add the chart and select it<restore-line-break>    ActiveSheet.Shapes.AddChart2(241, xlXYScatterLines).Select<restore-line-break>    <restore-line-break>    ' Set the source data<restore-line-break>    ActiveChart.SetSourceData Source:= ActiveSheet.Range("$A$1:$B$7")<restore-line-break>    <restore-line-break>    ' Set scales for x and y axes<restore-line-break>    ' X-axis<restore-line-break>    ActiveChart.Axes(xlCategory).MaximumScale = 100<restore-line-break>    ' Y-axis<restore-line-break>    ActiveChart.Axes(xlValue).MinimumScale = 150<restore-line-break><restore-line-break>    ' Set the height and width of the chart<restore-line-break>    With ActiveChart.Parent<restore-line-break>        .Height = 300<restore-line-break>        .Width = 600<restore-line-break>    End With<restore-line-break>    <restore-line-break>    ' Set chart title<restore-line-break>    ActiveChart.ChartTitle.Text = "Fuel consumption at different loads"<restore-line-break>    ' Add axis titles<restore-line-break>    With ActiveChart<restore-line-break>        'X axis name<restore-line-break>        .Axes(xlCategory, xlPrimary).HasTitle = True<restore-line-break>        .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = ActiveSheet.Range("A1").Value<restore-line-break>        'y-axis name<restore-line-break>        .Axes(xlValue, xlPrimary).HasTitle = True<restore-line-break>        .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = ActiveSheet.Range("B1").Value<restore-line-break>    End With</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre><p>Happy coding!</p></div><aside class="post__sidebar post__sidebar--left"><div class="sidebar sidebar--sticky"><section class="sidebar__item"><h3 class="sidebar__title">Share on:</h3><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcreating-and-formatting-a-chart-automatically-in-excel-with-vba%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer">Facebook </a><a href="https://twitter.com/share?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcreating-and-formatting-a-chart-automatically-in-excel-with-vba%2F&amp;via=connysoderholm.com&amp;text=Creating%20and%20formatting%20a%20chart%20automatically%20in%20Excel%20with%20VBA" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer">Twitter </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcreating-and-formatting-a-chart-automatically-in-excel-with-vba%2F&amp;media=undefined&amp;description=Creating%20and%20formatting%20a%20chart%20automatically%20in%20Excel%20with%20VBA" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer">Pinterest </a><a href="https://mix.com/add?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcreating-and-formatting-a-chart-automatically-in-excel-with-vba%2F" class="js-share mix" title="Share with Mix" rel="nofollow noopener noreferrer">Mix </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcreating-and-formatting-a-chart-automatically-in-excel-with-vba%2F" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer">LinkedIn </a><a href="https://buffer.com/add?text=Creating%20and%20formatting%20a%20chart%20automatically%20in%20Excel%20with%20VBA&amp;url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcreating-and-formatting-a-chart-automatically-in-excel-with-vba%2F" class="js-share buffer" title="Share with Buffer" rel="nofollow noopener noreferrer">Buffer </a><a href="https://api.whatsapp.com/send?text=Creating%20and%20formatting%20a%20chart%20automatically%20in%20Excel%20with%20VBA https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fcreating-and-formatting-a-chart-automatically-in-excel-with-vba%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer">WhatsApp</a></div></section><section class="sidebar__item"><h3 class="sidebar__title">Tagged in:</h3><div class="post__tag"><ul><li><a href="https://consod.github.io/connysoderholm.com/tags/chart/" title="chart">chart</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/excel/" title="Excel">Excel</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/vba/" title="VBA">VBA</a></li></ul></div></section><nav class="sidebar__item post__nav"><div class="post__nav__prev"><h3 class="sidebar__title">Previous post:</h3><a href="https://consod.github.io/connysoderholm.com/cell-data-validation-in-excel/" rel="next">Cell Data Validation in Excel</a></div><div class="post__nav__next"><h3 class="sidebar__title">Next post:</h3><a href="https://consod.github.io/connysoderholm.com/creating-a-button-in-tkinter/" rel="next">Creating a button in Tkinter</a></div></nav></div></aside><footer class="post__footer"><div class="post__author"><div><h3 class="h6"><a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" rel="author">Conny Söderholm</a></h3></div></div></footer></article><div class="post__related"><h3>Related post</h3><div class="l-grid"><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/mapping-and-importingexporting-an-xml-schema-to-excel/">Mapping and importing/exporting an XML schema to Excel</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/excel/" class="metadata__maintag">Excel</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2019-07-31T21:50" class="metadata__date">31.07.2019</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/excel-vba-and-the-worksheetchange-event/">Excel, VBA, and the Worksheet.Change Event</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/excel/" class="metadata__maintag">Excel</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-17T18:08" class="metadata__date">17.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-do-you-copy-an-excel-2016-formula-without-changing-the-cell-references/">How do you copy an Excel 2016 formula without changing the cell references?</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/copying/" class="metadata__maintag">Copying</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-13T21:58" class="metadata__date">13.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-to-reference-cells-and-sheets-indirectly-in-excel-2016/">How to Reference cells and sheets indirectly in Excel 2016</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/address/" class="metadata__maintag">ADDRESS</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-08T23:38" class="metadata__date">08.06.2018</time></div></div></article></div></div></main><footer class="footer"><div class="footer__top"><a class="logo footer__logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a></div><div class="footer__bottom"><div class="footer__copyright"></div></div></footer></div><script defer="defer" src="https://consod.github.io/connysoderholm.com/assets/js/scripts.min.js?v=01200278524b74ccf3210b7882b81e59"></script><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script>var images = document.querySelectorAll('img[loading]');
      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
            images[i].classList.add('is-loaded');
            images[i].parentNode.classList.remove('is-img-loading');
            images[i].parentNode.parentNode.classList.remove('is-img-loading');
         } else {
            images[i].addEventListener('load', function () {
               this.classList.add('is-loaded');
               this.parentNode.classList.remove('is-img-loading');
               this.parentNode.parentNode.classList.remove('is-img-loading');
            }, false);
         }
      }</script></body></html>