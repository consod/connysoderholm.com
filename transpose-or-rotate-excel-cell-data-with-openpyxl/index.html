<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Transpose or rotate Excel cell data with OpenPyXL - connysoderholm.com</title><meta name="description" content="In Excel there is a neat Paste Special method named Transpose. The transpose is done by copying your cells and then pasting the data to another place with the transpose option. We can easily do the same with Python and OpenPyXL. There are currently (To&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://consod.github.io/connysoderholm.com/transpose-or-rotate-excel-cell-data-with-openpyxl/"><link rel="alternate" type="application/atom+xml" href="https://consod.github.io/connysoderholm.com/feed.xml"><link rel="alternate" type="application/json" href="https://consod.github.io/connysoderholm.com/feed.json"><meta property="og:title" content="Transpose or rotate Excel cell data with OpenPyXL"><meta property="og:site_name" content="connysoderholm.com"><meta property="og:description" content="In Excel there is a neat Paste Special method named Transpose. The transpose is done by copying your cells and then pasting the data to another place with the transpose option. We can easily do the same with Python and OpenPyXL. There are currently (To&hellip;"><meta property="og:url" content="https://consod.github.io/connysoderholm.com/transpose-or-rotate-excel-cell-data-with-openpyxl/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://consod.github.io/connysoderholm.com/assets/css/style.css?v=7481e241a067a533a35b659302b5203e"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://consod.github.io/connysoderholm.com/transpose-or-rotate-excel-cell-data-with-openpyxl/"},"headline":"Transpose or rotate Excel cell data with OpenPyXL","datePublished":"2019-12-27T22:28","dateModified":"2023-05-03T21:57","description":"In Excel there is a neat Paste Special method named Transpose. The transpose is done by copying your cells and then pasting the data to another place with the transpose option. We can easily do the same with Python and OpenPyXL. There are currently (To&hellip;","author":{"@type":"Person","name":"Conny Söderholm","url":"https://consod.github.io/connysoderholm.com/authors/conny-soederholm/"},"publisher":{"@type":"Organization","name":"Conny Söderholm"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><div class="top__inner" id="js-post__progress"><a class="logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a><nav class="navbar js-navbar"><button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle__box"><span class="navbar__toggle__inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://consod.github.io/connysoderholm.com/about-me/" target="_self">About me</a></li></ul></nav></div></header><main class="main"><article class="post post--sidebar-left"><header class="post__header"><h1 class="post__title">Transpose or rotate Excel cell data with OpenPyXL</h1><div class="metadata"><a href="https://consod.github.io/connysoderholm.com/tags/excel/" class="metadata__maintag">Excel</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2019-12-27T22:28" class="metadata__date">27.12.2019</time><div class="metadata__update">(Updated on <time datetime="2023-05-03T21:57">03.05.2023 </time>)</div></div></header><div class="post__entry"><p></p><h2>Introduction</h2><p></p><p>In Excel there is a neat Paste Special method named <em>Transpose</em>. The <a href="https://support.office.com/en-us/article/transpose-rotate-data-from-rows-to-columns-or-vice-versa-3419f2e3-beab-4318-aae5-d0f862209744" target="_blank" rel="noopener noreferrer">transpose</a> is done by copying your cells and then pasting the data to another place with the transpose option. We can easily do the same with <a href="https://python.org/" target="_blank" rel="noopener noreferrer">Python</a> and <a href="https://openpyxl.readthedocs.io/en/stable/" target="_blank" rel="noopener noreferrer">OpenPyXL</a>.</p><p></p><figure class="wp-block-image size-large"><figure class="wp-image-541"><img loading="lazy" src="https://consod.github.io/connysoderholm.com/media/posts/45/image-1.png" alt="" sizes="(min-width: 1260px) calc(3.22vw + 703px), (min-width: 900px) calc(50.59vw + 116px), (min-width: 840px) calc(5vw + 684px), calc(85.58vw + 23px)" srcset="https://consod.github.io/connysoderholm.com/media/posts/45/responsive/image-1-xs.png 320w, https://consod.github.io/connysoderholm.com/media/posts/45/responsive/image-1-sm.png 480w, https://consod.github.io/connysoderholm.com/media/posts/45/responsive/image-1-md.png 768w"></figure><figcaption>Transposed cells in Excel.</figcaption></figure><p></p><p></p><p>There are currently (To the author's knowledge, December 2019) no transpose functions or methods written in OpenPyXL. I have made a small code sample that transposes rows to columns and columns to rows. Only cell data is transposed with these functions. The functions are divided into three main functions.</p><p></p><p></p><h2>The functions</h2><p></p><p></p><h3>Transpose</h3><p></p><p></p><p>The first function is Transpose, which takes an OpenPyXL worksheet and which rows and columns to transpose the values to/from. The function uses two loops, which first traverses the rows and then the columns. We set the worksheet's cell values with <code>ws.cell(row=col,column=row).value = ws.cell(row=row,column=col).value</code>. To set the values, we just invert the column and row values.</p><p></p><p></p><h3>Transpose_row_to_col and transpose_col_to_row</h3><p></p><p></p><p>I have expanded these functions to accept also the target cell to paste the values in, and also the option to delete the transposed cells values. The functions are identical except for the usage of <a rel="noreferrer noopener" aria-label="iter_rows (opens in a new tab)" href="https://openpyxl.readthedocs.io/en/stable/api/openpyxl.worksheet.worksheet.html#openpyxl.worksheet.worksheet.Worksheet.iter_rows" target="_blank">iter_rows</a> and <a rel="noreferrer noopener" aria-label="iter_cols (opens in a new tab)" href="https://openpyxl.readthedocs.io/en/stable/api/openpyxl.worksheet.worksheet.html#openpyxl.worksheet.worksheet.Worksheet.iter_cols" target="_blank">iter_cols</a>. The <code>target_cell_address</code> is a tuple consisting of the cell's absolute address. If <code>delete_source</code> is True the values in the transposed cells are deleted.</p><p></p><p></p><p>First, an empty list called <code>cell_values</code> is created. After that we use the iter_rows method to iterate through the worksheets rows, one by one. The iter_rows produces cells from the worksheet, by row while the iter_cols returns cells by column. The cells are yielded from a <a rel="noreferrer noopener" aria-label="generator (opens in a new tab)" href="https://wiki.python.org/moin/Generators" target="_blank">generator</a>.</p><p></p><p></p><p>We append the values of the cells to our <code>cell_ranges</code> list. We then use the <code>fill_cells</code> function to enter the values again to our transposed cells.</p><p></p><p></p><p>I hope that this helps you in transposing and rotating your cell values. As always, if you have any questions or comments please let me know.</p><p></p><p></p><h2>Complete code</h2><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="python" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">#!/usr/bin/env python3<restore-line-break><restore-line-break>"""<restore-line-break>Transpose row values to column values and vice versa<restore-line-break>"""<restore-line-break><restore-line-break>import openpyxl<restore-line-break><restore-line-break>def transpose(ws, min_row, max_row, min_col, max_col):<restore-line-break>    for row in range(min_row, max_row+1):<restore-line-break>        for col in range(min_col, max_col+1):<restore-line-break>            ws.cell(row=col,column=row).value = ws.cell(row=row,column=col).value<restore-line-break><restore-line-break>def transpose_row_to_col(ws, min_row, max_row, min_col, max_col, target_cell_address=(1,1), delete_source=False):<restore-line-break>    cell_values = []<restore-line-break>    for row in ws.iter_rows(min_row=min_row, max_row=max_row, min_col=min_col, max_col=max_col):<restore-line-break>        for cell in row:<restore-line-break>            cell_values.append(cell.value)<restore-line-break>            if delete_source:<restore-line-break>                cell.value = ""<restore-line-break>    fill_cells(ws, target_cell_address[0], target_cell_address[1], cell_values)<restore-line-break>        <restore-line-break>def transpose_col_to_row(ws, min_row, max_row, min_col, max_col, target_cell_address=(1,1), delete_source=False):<restore-line-break>    cell_values = []<restore-line-break>    for col in ws.iter_cols(min_row=min_row, max_row=max_row, min_col=min_col, max_col=max_col):<restore-line-break>        for cell in col:<restore-line-break>            cell_values.append(cell.value)<restore-line-break>            if delete_source:<restore-line-break>                cell.value = ""<restore-line-break>    fill_cells(ws, target_cell_address[0], target_cell_address[1], cell_values)<restore-line-break><restore-line-break>def fill_cells(ws, start_row, start_column, cell_values):<restore-line-break>    row = start_row<restore-line-break>    column = start_column<restore-line-break>    for value in cell_values:<restore-line-break>        ws.cell(row=row,column=column).value = value<restore-line-break>        row += 1<restore-line-break><restore-line-break>if __name__ == "__main__":<restore-line-break>    # Open workbook<restore-line-break>    file_name = "Transpose_cell_values.xlsx"<restore-line-break>    wb = openpyxl.load_workbook(file_name)<restore-line-break>    ws1 = wb.worksheets[0]<restore-line-break>    transpose(ws1, min_row=1, max_row=1, min_col=1, max_col=5)<restore-line-break>    #transpose_col_to_row(ws1, min_row=1, max_row=10, min_col=1, max_col=1, target_cell_address=(1,2))<restore-line-break>    wb.save(file_name)</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre><p></p></div><aside class="post__sidebar post__sidebar--left"><div class="sidebar sidebar--sticky"><section class="sidebar__item"><h3 class="sidebar__title">Share on:</h3><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Ftranspose-or-rotate-excel-cell-data-with-openpyxl%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer">Facebook </a><a href="https://twitter.com/share?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Ftranspose-or-rotate-excel-cell-data-with-openpyxl%2F&amp;via=connysoderholm.com&amp;text=Transpose%20or%20rotate%20Excel%20cell%20data%20with%20OpenPyXL" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer">Twitter </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Ftranspose-or-rotate-excel-cell-data-with-openpyxl%2F&amp;media=undefined&amp;description=Transpose%20or%20rotate%20Excel%20cell%20data%20with%20OpenPyXL" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer">Pinterest </a><a href="https://mix.com/add?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Ftranspose-or-rotate-excel-cell-data-with-openpyxl%2F" class="js-share mix" title="Share with Mix" rel="nofollow noopener noreferrer">Mix </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Ftranspose-or-rotate-excel-cell-data-with-openpyxl%2F" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer">LinkedIn </a><a href="https://buffer.com/add?text=Transpose%20or%20rotate%20Excel%20cell%20data%20with%20OpenPyXL&amp;url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Ftranspose-or-rotate-excel-cell-data-with-openpyxl%2F" class="js-share buffer" title="Share with Buffer" rel="nofollow noopener noreferrer">Buffer </a><a href="https://api.whatsapp.com/send?text=Transpose%20or%20rotate%20Excel%20cell%20data%20with%20OpenPyXL https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Ftranspose-or-rotate-excel-cell-data-with-openpyxl%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer">WhatsApp</a></div></section><section class="sidebar__item"><h3 class="sidebar__title">Tagged in:</h3><div class="post__tag"><ul><li><a href="https://consod.github.io/connysoderholm.com/tags/excel/" title="Excel">Excel</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/openpyxl/" title="openpyxl">openpyxl</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/transpose/" title="Transpose">Transpose</a></li></ul></div></section><nav class="sidebar__item post__nav"><div class="post__nav__prev"><h3 class="sidebar__title">Previous post:</h3><a href="https://consod.github.io/connysoderholm.com/how-to-automatically-fill-a-column-with-days-of-the-week-in-excel/" rel="next">How to automatically fill a column with days of the week in Excel</a></div><div class="post__nav__next"><h3 class="sidebar__title">Next post:</h3><a href="https://consod.github.io/connysoderholm.com/rotate-pdf-files-with-pypdf2-and-tkinter/" rel="next">Rotate PDF files with PyPdf2 and Tkinter!</a></div></nav></div></aside><footer class="post__footer"><div class="post__author"><div><h3 class="h6"><a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" rel="author">Conny Söderholm</a></h3></div></div></footer></article><div class="post__related"><h3>Related post</h3><div class="l-grid"><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/creating-and-formatting-a-chart-automatically-in-excel-with-vba/">Creating and formatting a chart automatically in Excel with VBA</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/chart/" class="metadata__maintag">chart</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-07-03T22:07" class="metadata__date">03.07.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/excel-vba-and-the-worksheetchange-event/">Excel, VBA, and the Worksheet.Change Event</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/excel/" class="metadata__maintag">Excel</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-17T18:08" class="metadata__date">17.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-do-you-copy-an-excel-2016-formula-without-changing-the-cell-references/">How do you copy an Excel 2016 formula without changing the cell references?</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/copying/" class="metadata__maintag">Copying</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-13T21:58" class="metadata__date">13.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-to-reference-cells-and-sheets-indirectly-in-excel-2016/">How to Reference cells and sheets indirectly in Excel 2016</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/address/" class="metadata__maintag">ADDRESS</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-08T23:38" class="metadata__date">08.06.2018</time></div></div></article></div></div></main><footer class="footer"><div class="footer__top"><a class="logo footer__logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a></div><div class="footer__bottom"><div class="footer__copyright"></div></div></footer></div><script defer="defer" src="https://consod.github.io/connysoderholm.com/assets/js/scripts.min.js?v=01200278524b74ccf3210b7882b81e59"></script><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script>var images = document.querySelectorAll('img[loading]');
      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
            images[i].classList.add('is-loaded');
            images[i].parentNode.classList.remove('is-img-loading');
            images[i].parentNode.parentNode.classList.remove('is-img-loading');
         } else {
            images[i].addEventListener('load', function () {
               this.classList.add('is-loaded');
               this.parentNode.classList.remove('is-img-loading');
               this.parentNode.parentNode.classList.remove('is-img-loading');
            }, false);
         }
      }</script></body></html>