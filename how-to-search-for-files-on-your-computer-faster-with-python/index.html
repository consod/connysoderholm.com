<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>How to search for files on your computer faster with Python - connysoderholm.com</title><meta name="description" content="How to search for files on your computer faster with Python - When I use the Windows Explorer search while looking for particular files on the network drive I usually go for a coffee while the search is running. It takes painfully long to search for files and it is just frustrating when you cannot find files after a 10 min search. What you can do instead is to write some code and let Python do the searching for you."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://consod.github.io/connysoderholm.com/how-to-search-for-files-on-your-computer-faster-with-python/"><link rel="alternate" type="application/atom+xml" href="https://consod.github.io/connysoderholm.com/feed.xml"><link rel="alternate" type="application/json" href="https://consod.github.io/connysoderholm.com/feed.json"><meta property="og:title" content="How to search for files on your computer faster with Python"><meta property="og:site_name" content="connysoderholm.com"><meta property="og:description" content="How to search for files on your computer faster with Python - When I use the Windows Explorer search while looking for particular files on the network drive I usually go for a coffee while the search is running. It takes painfully long to search for files and it is just frustrating when you cannot find files after a 10 min search. What you can do instead is to write some code and let Python do the searching for you."><meta property="og:url" content="https://consod.github.io/connysoderholm.com/how-to-search-for-files-on-your-computer-faster-with-python/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://consod.github.io/connysoderholm.com/assets/css/style.css?v=7481e241a067a533a35b659302b5203e"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://consod.github.io/connysoderholm.com/how-to-search-for-files-on-your-computer-faster-with-python/"},"headline":"How to search for files on your computer faster with Python","datePublished":"2018-06-28T20:52","dateModified":"2023-05-03T21:57","description":"How to search for files on your computer faster with Python - When I use the Windows Explorer search while looking for particular files on the network drive I usually go for a coffee while the search is running. It takes painfully long to search for files and it is just frustrating when you cannot find files after a 10 min search. What you can do instead is to write some code and let Python do the searching for you.","author":{"@type":"Person","name":"Conny Söderholm","url":"https://consod.github.io/connysoderholm.com/authors/conny-soederholm/"},"publisher":{"@type":"Organization","name":"Conny Söderholm"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><div class="top__inner" id="js-post__progress"><a class="logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a></div></header><main class="main"><article class="post post--sidebar-left"><header class="post__header"><h1 class="post__title">How to search for files on your computer faster with Python</h1><div class="metadata"><a href="https://consod.github.io/connysoderholm.com/tags/file/" class="metadata__maintag">file</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-28T20:52" class="metadata__date">28.06.2018</time><div class="metadata__update">(Updated on <time datetime="2023-05-03T21:57">03.05.2023 </time>)</div></div></header><div class="post__entry"><p><em>How to search for files on your computer faster with Python</em> - When I use the Windows Explorer search while looking for particular files on the network drive I usually go for a coffee while the search is running. It takes painfully long to search for files and it is just frustrating when you cannot find files after a 10 min search. What you can do instead is to write some code and let Python do the searching for you.</p><p>It took me 0 minutes and 21.0 seconds for searching folder contents for the letter "a" in my whole C: drive with 130 GB occupied disk space.  I Found 247588 search results for a. It is not that useful search of course, but it shows how fast you can do searches.</p><p>Let's have a look at the code below. We start by asking the user where the directory we want to search is. If the user presses cancel on the askdirectory <a href="https://connysoderholm.com/file-dialog-box-tkinter/">filedialog</a> we exit the application. We then add a slash to the end of the folder name if needed. Next, we get the folder path with the os.path.dirname method.  We then get the preceding folder path and the name of the search folder with os.path.split.</p><p>Next, we perform some error checking in case the folder name is blank and also ask the user what to search for. We then start the clock with time.time() so we know how long the search took. We then create the search contents file. Remember to put some encoding in or you might get an UnicodeError, I use utf-8. The os.walk module walks through each folder in the directory.</p><p>the script is finished, now we just have to give some information to the user. The search file will be saved in the same folder as the script is located in. If you want more information about dealing with folder contents I have two other blog posts about <a href="https://connysoderholm.com/create-folders-from-a-text-file-line-by-line-with-python/">creating folders from a text file</a> and <a href="https://connysoderholm.com/folder-file-contents-to-text-python/">how to read folder file contents into a text file</a> with Python. Happy coding!</p><pre class="EnlighterJSRAW" data-enlighter-language="python">#! python3<restore-line-break># -*- coding: utf-8 -*-<restore-line-break><restore-line-break>"""<restore-line-break>By: Conny Söderholm<restore-line-break><restore-line-break>Reads the search results of a specified folder or drive<restore-line-break>into text file.<restore-line-break><restore-line-break>In Python, there are a number of functions in the os.path<restore-line-break>module that change forward slashes in a string to the<restore-line-break>appropriate filename separator for the platform that you<restore-line-break>are on. One of these function is os.path.normpath()<restore-line-break>The trick is to enter all of your filename strings using<restore-line-break>forward slashes, and then let os.path.normpath() change<restore-line-break>them to backslashes for you, this way.<restore-line-break><restore-line-break>myDirname = os.path.normpath("c:/aDirname/")<restore-line-break><restore-line-break>"""<restore-line-break><restore-line-break>import os<restore-line-break>import time<restore-line-break>import tkinter as tk<restore-line-break>from tkinter.filedialog import askdirectory<restore-line-break><restore-line-break>tk.Tk().withdraw() # Close the root window<restore-line-break><restore-line-break>folder_to_read = askdirectory()<restore-line-break><restore-line-break>if folder_to_read == "":<restore-line-break>    print("Exiting program")<restore-line-break>    quit()<restore-line-break><restore-line-break>if folder_to_read[-1] != '/':<restore-line-break>    folder_to_read += '/'<restore-line-break><restore-line-break>folder_path = os.path.dirname(folder_to_read)<restore-line-break><restore-line-break>path,folder_name = os.path.split(folder_path)<restore-line-break><restore-line-break>if folder_name is "":<restore-line-break>    folder_name = folder_to_read<restore-line-break>    if folder_name[-2:] == ':/':<restore-line-break>        folder_name = folder_name[:-2]<restore-line-break><restore-line-break>search_string = ""<restore-line-break>while search_string is "":<restore-line-break>    search_string = input("Enter the name of the file(s) you want to search for:\n").lower()<restore-line-break><restore-line-break>search_results_found = 0<restore-line-break>print("starting to search for the files...")<restore-line-break><restore-line-break>start_time = time.time()<restore-line-break><restore-line-break>with open(folder_name + " folder_search_results.txt", "w", encoding="utf-8") as a:<restore-line-break>    a.write("Searches found for " + search_string + ":\n")<restore-line-break>    for search_path, subdirs, files in os.walk(os.path.normpath(folder_to_read)):<restore-line-break>        for filename in files:<restore-line-break>            f = os.path.join(search_path, filename)<restore-line-break>            if search_string in f.lower():<restore-line-break>                search_results_found += 1<restore-line-break>                a.write( f + os.linesep)<restore-line-break><restore-line-break>seconds = time.time() - start_time<restore-line-break><restore-line-break>m, s = divmod(seconds, 60)<restore-line-break>h, m = divmod(m, 60)<restore-line-break><restore-line-break>print("{:.0f} minutes and {:.1f} seconds used for searching folder contents for {}".format( m, s, search_string ))<restore-line-break>print("Found {} search results for {}".format(search_results_found, search_string))<restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre></div><aside class="post__sidebar post__sidebar--left"><div class="sidebar sidebar--sticky"><section class="sidebar__item"><h3 class="sidebar__title">Share on:</h3><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-search-for-files-on-your-computer-faster-with-python%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer">Facebook </a><a href="https://twitter.com/share?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-search-for-files-on-your-computer-faster-with-python%2F&amp;via=connysoderholm.com&amp;text=How%20to%20search%20for%20files%20on%20your%20computer%20faster%20with%20Python" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer">Twitter </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-search-for-files-on-your-computer-faster-with-python%2F&amp;media=undefined&amp;description=How%20to%20search%20for%20files%20on%20your%20computer%20faster%20with%20Python" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer">Pinterest </a><a href="https://mix.com/add?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-search-for-files-on-your-computer-faster-with-python%2F" class="js-share mix" title="Share with Mix" rel="nofollow noopener noreferrer">Mix </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-search-for-files-on-your-computer-faster-with-python%2F" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer">LinkedIn </a><a href="https://buffer.com/add?text=How%20to%20search%20for%20files%20on%20your%20computer%20faster%20with%20Python&amp;url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-search-for-files-on-your-computer-faster-with-python%2F" class="js-share buffer" title="Share with Buffer" rel="nofollow noopener noreferrer">Buffer </a><a href="https://api.whatsapp.com/send?text=How%20to%20search%20for%20files%20on%20your%20computer%20faster%20with%20Python https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-search-for-files-on-your-computer-faster-with-python%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer">WhatsApp</a></div></section><section class="sidebar__item"><h3 class="sidebar__title">Tagged in:</h3><div class="post__tag"><ul><li><a href="https://consod.github.io/connysoderholm.com/tags/file/" title="file">file</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/python/" title="Python">Python</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/search/" title="search">search</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/tkinter-askdirectory/" title="tkinter askdirectory">tkinter askdirectory</a></li></ul></div></section><nav class="sidebar__item post__nav"><div class="post__nav__prev"><h3 class="sidebar__title">Previous post:</h3><a href="https://consod.github.io/connysoderholm.com/playing-super-mario-theme-music-with-python/" rel="next">Playing Super Mario theme music with Python</a></div><div class="post__nav__next"><h3 class="sidebar__title">Next post:</h3><a href="https://consod.github.io/connysoderholm.com/searching-for-text-in-pdf-files-with-pypdf2/" rel="next">Searching for text in PDF files with pypdf2</a></div></nav></div></aside><footer class="post__footer"><div class="post__author"><div><h3 class="h6"><a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" rel="author">Conny Söderholm</a></h3></div></div></footer></article><div class="post__related"><h3>Related post</h3><div class="l-grid"><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/playing-super-mario-theme-music-with-python/">Playing Super Mario theme music with Python</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/beep/" class="metadata__maintag">Beep</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-27T23:54" class="metadata__date">27.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-to-read-folder-file-contents-into-a-text-file-with-python/">How to read folder file contents into a text file with Python</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/getcwd/" class="metadata__maintag">getcwd</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-25T23:36" class="metadata__date">25.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/create-folders-from-a-text-file-line-by-line-with-python/">Create folders from a text file, line by line with Python</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/folder/" class="metadata__maintag">folder</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-23T15:14" class="metadata__date">23.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/printing-dates-in-python-with-the-datetime-module/">Printing dates in Python with the datetime module</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/datetime/" class="metadata__maintag">datetime</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-20T19:44" class="metadata__date">20.06.2018</time></div></div></article></div></div></main><footer class="footer"><div class="footer__top"><a class="logo footer__logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a></div><div class="footer__bottom"><div class="footer__copyright"></div></div></footer></div><script defer="defer" src="https://consod.github.io/connysoderholm.com/assets/js/scripts.min.js?v=01200278524b74ccf3210b7882b81e59"></script><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script>var images = document.querySelectorAll('img[loading]');
      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
            images[i].classList.add('is-loaded');
            images[i].parentNode.classList.remove('is-img-loading');
            images[i].parentNode.parentNode.classList.remove('is-img-loading');
         } else {
            images[i].addEventListener('load', function () {
               this.classList.add('is-loaded');
               this.parentNode.classList.remove('is-img-loading');
               this.parentNode.parentNode.classList.remove('is-img-loading');
            }, false);
         }
      }</script></body></html>