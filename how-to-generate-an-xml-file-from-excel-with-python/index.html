<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>How to generate an XML file from Excel with Python - connysoderholm.com</title><meta name="description" content="In this post, we will take a look into how we can generate Extensible Markup Language&nbsp;(XML) files from an Excel file with Python. We will be using the Yattag package to generate our XML file and the OpenPyXL package for reading our Excel data. Yattag&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://consod.github.io/connysoderholm.com/how-to-generate-an-xml-file-from-excel-with-python/"><link rel="alternate" type="application/atom+xml" href="https://consod.github.io/connysoderholm.com/feed.xml"><link rel="alternate" type="application/json" href="https://consod.github.io/connysoderholm.com/feed.json"><meta property="og:title" content="How to generate an XML file from Excel with Python"><meta property="og:site_name" content="connysoderholm.com"><meta property="og:description" content="In this post, we will take a look into how we can generate Extensible Markup Language&nbsp;(XML) files from an Excel file with Python. We will be using the Yattag package to generate our XML file and the OpenPyXL package for reading our Excel data. Yattag&hellip;"><meta property="og:url" content="https://consod.github.io/connysoderholm.com/how-to-generate-an-xml-file-from-excel-with-python/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://consod.github.io/connysoderholm.com/assets/css/style.css?v=7481e241a067a533a35b659302b5203e"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://consod.github.io/connysoderholm.com/how-to-generate-an-xml-file-from-excel-with-python/"},"headline":"How to generate an XML file from Excel with Python","datePublished":"2019-12-22T20:56","dateModified":"2023-05-03T21:57","description":"In this post, we will take a look into how we can generate Extensible Markup Language&nbsp;(XML) files from an Excel file with Python. We will be using the Yattag package to generate our XML file and the OpenPyXL package for reading our Excel data. Yattag&hellip;","author":{"@type":"Person","name":"Conny Söderholm","url":"https://consod.github.io/connysoderholm.com/authors/conny-soederholm/"},"publisher":{"@type":"Organization","name":"Conny Söderholm"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><div class="top__inner" id="js-post__progress"><a class="logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a></div></header><main class="main"><article class="post post--sidebar-left"><header class="post__header"><h1 class="post__title">How to generate an XML file from Excel with Python</h1><div class="metadata"><a href="https://consod.github.io/connysoderholm.com/tags/excel/" class="metadata__maintag">Excel</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2019-12-22T20:56" class="metadata__date">22.12.2019</time><div class="metadata__update">(Updated on <time datetime="2023-05-03T21:57">03.05.2023 </time>)</div></div></header><div class="post__entry"><p></p><h2>Introduction</h2><p></p><p></p><p>In this post, we will take a look into how we can generate Extensible Markup Language&nbsp;(XML) files from an Excel file with Python. We will be using the Yattag package to generate our XML file and the<a rel="noreferrer noopener" aria-label=" OpenPyXL (opens in a new tab)" href="https://openpyxl.readthedocs.io/" target="_blank"> OpenPyXL</a> package for reading our Excel data.</p><p></p><p></p><h2>Packages</h2><p></p><p></p><h3>Yattag</h3><p></p><p></p><p><a href="https://www.yattag.org/" target="_blank" rel="noreferrer noopener" aria-label="Yattag (opens in a new tab)">Yattag</a> is described in its documentation as following:</p><p></p><p></p><blockquote class="wp-block-quote"><p>Yattag is a&nbsp;<strong>Python library</strong>&nbsp;for generating&nbsp;<strong>HTML</strong>&nbsp;or&nbsp;<strong>XML</strong>&nbsp;in a&nbsp;<strong>pythonic</strong>&nbsp;way.</p></blockquote><p></p><p></p><p>That pretty much sums Yatttag up, I find it as a simple, easy to use library that just works. I had been searching for this kind of library in order to more easily generate different XML files.</p><p></p><p></p><p>To install Yattag with pip: <code>pip install yattag</code></p><p></p><p></p><h4>Using Yattag</h4><p></p><p></p><p>Adding a tag with Yattag is as easy as using the <code>With</code> keyword:</p><p></p><p></p><pre class="wp-block-preformatted">with tag('h1'):<restore-line-break>    text('Hello world!')</restore-line-break></pre><p></p><p></p><p>Tags are automatically closed. To start using Yattag we need to import Doc from Yattag and create our Doc, tag and text with Doc().tagtext().</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="python" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">from yattag import Doc<restore-line-break>doc, tag, text = Doc().tagtext()<restore-line-break>with tag('h1'):<restore-line-break>    text('Hello world!')<restore-line-break>doc.getvalue()<restore-line-break><restore-line-break>Output:<restore-line-break>'
<h1>Hello world!</h1>
<p>'</p></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre><p></p><p></p><h3>OpenPyXL</h3><p></p><p></p><p><a rel="noreferrer noopener" aria-label="OpenPyXL  (opens in a new tab)" href="https://openpyxl.readthedocs.io/" target="_blank">OpenPyXL </a>is a library for interacting with Excel 2010 files. OpenPyXL can read and write to .xlsx and .xlsm files.</p><p></p><p></p><p>To install OpenPyXL with pip: <code>pip install openpyxl</code></p><p></p><p></p><h4>Using OpenPyXL</h4><p></p><p></p><p>To load an existing workbook in OpenPyXl we need to use the <code>load_workbook</code> method. We also need to select the sheet we are reading the data from. In our example, we are using popular baby names in New York City. You can access the dataset from the link at the bottom of this post.</p><p></p><p></p><p>I have created a workbook named NY_baby_names.xlsx with one sheet of data, Sheet1. The worksheet has the following headers: Year of Birth, Gender, Child's First Name, Count, Rank. You can download the Excel file from <a href="https://connysoderholm.com/wp-content/uploads/2019/12/NY_baby_names.xlsx">my website here</a>.</p><p></p><p></p><p>To access the data with OpenPyXL, do the following:</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">from openpyxl import load_workbook<restore-line-break>wb = load_workbook("NY_baby_names.xlsx")<restore-line-break>ws = wb.worksheets[0]<restore-line-break>for row in ws.iter_rows(min_row=1, max_row=2, min_col=1, max_col=4):<restore-line-break>    print([cell.value for cell in row])<restore-line-break><restore-line-break>Output: <restore-line-break>['Year of Birth', 'Gender', "Child's First Name", 'Count']<restore-line-break>[2011, 'FEMALE', 'GERALDINE', 13]</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre><p></p><p></p><p>First, we load the workbook with <code>load_workbook</code>, and then select the first worksheet. We then iterate through the first two rows with the <code>iter_rows</code> method.</p><p></p><p></p><h2>Generating the XML from Excel</h2><p></p><p></p><p>After the imports, we load the workbook and the worksheet. We then create our Yattag document. We fill the headers with Yattags <code>asis()</code> method. The asis method enables us to input any string as the next line.</p><p></p><p></p><p>We then create our main tag, Babies. We start looping through our sheet with the<code>iter_rows</code> method. The<code>iter_rows</code>method returns a generator with all the cells. We use a list comprehension to get all the values from the cells.</p><p></p><p></p><p>Next, we are adding the babies. Notice the use of the With tag and text. When we are finished we indent our result with Yattags indent method.</p><p></p><p></p><p>Finally, we save our file. The output should look like below. Notice that I only included two babies in the output.</p><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group=""><?xml version="1.0" encoding="UTF-8"?><restore-line-break><xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"></xs:schema><restore-line-break><babies><restore-line-break>    <baby><restore-line-break>        <name><restore-line-break>            GERALDINE<restore-line-break>        </restore-line-break></restore-line-break></name><restore-line-break>        <gender><restore-line-break>            FEMALE<restore-line-break>        </restore-line-break></restore-line-break></gender><restore-line-break>        <year><restore-line-break>            2011<restore-line-break>        </restore-line-break></restore-line-break></year><restore-line-break>        <count><restore-line-break>            13<restore-line-break>        </restore-line-break></restore-line-break></count><restore-line-break>        <rank><restore-line-break>            75<restore-line-break>        </restore-line-break></restore-line-break></rank><restore-line-break>    </restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></baby><restore-line-break>    <baby><restore-line-break>        <name><restore-line-break>            GIA<restore-line-break>        </restore-line-break></restore-line-break></name><restore-line-break>        <gender><restore-line-break>            FEMALE<restore-line-break>        </restore-line-break></restore-line-break></gender><restore-line-break>        <year><restore-line-break>            2011<restore-line-break>        </restore-line-break></restore-line-break></year><restore-line-break>        <count><restore-line-break>            21<restore-line-break>        </restore-line-break></restore-line-break></count><restore-line-break>        <rank><restore-line-break>            67<restore-line-break>        </restore-line-break></restore-line-break></rank><restore-line-break>    </restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></baby><restore-line-break></restore-line-break></restore-line-break></restore-line-break></babies></restore-line-break></restore-line-break></pre><p></p><p></p><h2>Complete code</h2><p></p><p></p><pre class="EnlighterJSRAW" data-enlighter-language="generic" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">from openpyxl import load_workbook<restore-line-break>from yattag import Doc, indent<restore-line-break><restore-line-break>wb = load_workbook("NY_baby_names.xlsx")<restore-line-break>ws = wb.worksheets[0]<restore-line-break><restore-line-break># Create Yattag doc, tag and text objects<restore-line-break>doc, tag, text = Doc().tagtext()<restore-line-break><restore-line-break>xml_header = '<?xml version="1.0" encoding="UTF-8"?>'<restore-line-break>xml_schema = '<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"></xs:schema>'<restore-line-break><restore-line-break>doc.asis(xml_header)<restore-line-break>doc.asis(xml_schema)<restore-line-break><restore-line-break>with tag('Babies'):<restore-line-break>    # Use ws.max_row for all rows<restore-line-break>    for row in ws.iter_rows(min_row=2, max_row=100, min_col=1, max_col=5):<restore-line-break>        row = [cell.value for cell in row]<restore-line-break>        with tag("Baby"):<restore-line-break>            with tag("Name"):<restore-line-break>                text(row[2])<restore-line-break>            with tag("Gender"):<restore-line-break>                text(row[1])<restore-line-break>            with tag("year"):<restore-line-break>                text(row[0])<restore-line-break>            with tag("count"):<restore-line-break>                text(row[3])<restore-line-break>            with tag("rank"):<restore-line-break>                text(row[4])<restore-line-break><restore-line-break>result = indent(<restore-line-break>    doc.getvalue(),<restore-line-break>    indentation = '    ',<restore-line-break>    indent_text = True<restore-line-break>)<restore-line-break><restore-line-break>with open("baby_names.xml", "w") as f:<restore-line-break>    f.write(result)</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre><p></p><p></p><h2>Data sets</h2><p></p><p></p><p>Popular Baby Names dataset: <a href="https://catalog.data.gov/dataset/most-popular-baby-names-by-sex-and-mothers-ethnic-group-new-york-city-8c742">https://catalog.data.gov/dataset/most-popular-baby-names-by-sex-and-mothers-ethnic-group-new-york-city-8c742</a></p><p></p></div><aside class="post__sidebar post__sidebar--left"><div class="sidebar sidebar--sticky"><section class="sidebar__item"><h3 class="sidebar__title">Share on:</h3><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-generate-an-xml-file-from-excel-with-python%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer">Facebook </a><a href="https://twitter.com/share?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-generate-an-xml-file-from-excel-with-python%2F&amp;via=connysoderholm.com&amp;text=How%20to%20generate%20an%20XML%20file%20from%20Excel%20with%20Python" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer">Twitter </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-generate-an-xml-file-from-excel-with-python%2F&amp;media=undefined&amp;description=How%20to%20generate%20an%20XML%20file%20from%20Excel%20with%20Python" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer">Pinterest </a><a href="https://mix.com/add?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-generate-an-xml-file-from-excel-with-python%2F" class="js-share mix" title="Share with Mix" rel="nofollow noopener noreferrer">Mix </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-generate-an-xml-file-from-excel-with-python%2F" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer">LinkedIn </a><a href="https://buffer.com/add?text=How%20to%20generate%20an%20XML%20file%20from%20Excel%20with%20Python&amp;url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-generate-an-xml-file-from-excel-with-python%2F" class="js-share buffer" title="Share with Buffer" rel="nofollow noopener noreferrer">Buffer </a><a href="https://api.whatsapp.com/send?text=How%20to%20generate%20an%20XML%20file%20from%20Excel%20with%20Python https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fhow-to-generate-an-xml-file-from-excel-with-python%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer">WhatsApp</a></div></section><section class="sidebar__item"><h3 class="sidebar__title">Tagged in:</h3><div class="post__tag"><ul><li><a href="https://consod.github.io/connysoderholm.com/tags/excel/" title="Excel">Excel</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/python/" title="Python">Python</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/xml/" title="XML">XML</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/yattag/" title="yattag">yattag</a></li></ul></div></section><nav class="sidebar__item post__nav"><div class="post__nav__prev"><h3 class="sidebar__title">Previous post:</h3><a href="https://consod.github.io/connysoderholm.com/copy-data-from-one-excel-workbook-to-a-new-workbook-with-python-and-openpyxl/" rel="next">Copy data from one Excel workbook to a new workbook with Python &amp; OpenPyXL</a></div><div class="post__nav__next"><h3 class="sidebar__title">Next post:</h3><a href="https://consod.github.io/connysoderholm.com/how-to-automatically-fill-a-column-with-days-of-the-week-in-excel/" rel="next">How to automatically fill a column with days of the week in Excel</a></div></nav></div></aside><footer class="post__footer"><div class="post__author"><div><h3 class="h6"><a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" rel="author">Conny Söderholm</a></h3></div></div></footer></article><div class="post__related"><h3>Related post</h3><div class="l-grid"><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/creating-a-simple-file-dialog-box-with-tkinter/">Creating a simple file dialog box with Tkinter</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/file-dialog/" class="metadata__maintag">File Dialog</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-14T20:47" class="metadata__date">14.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-do-you-copy-an-excel-2016-formula-without-changing-the-cell-references/">How do you copy an Excel 2016 formula without changing the cell references?</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/copying/" class="metadata__maintag">Copying</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-13T21:58" class="metadata__date">13.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-to-reference-cells-and-sheets-indirectly-in-excel-2016/">How to Reference cells and sheets indirectly in Excel 2016</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/address/" class="metadata__maintag">ADDRESS</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-08T23:38" class="metadata__date">08.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/saying-hello-world-with-tkinter/">Saying Hello World with tkinter</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/gui/" class="metadata__maintag">GUI</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-04T21:06" class="metadata__date">04.06.2018</time></div></div></article></div></div></main><footer class="footer"><div class="footer__top"><a class="logo footer__logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a></div><div class="footer__bottom"><div class="footer__copyright"></div></div></footer></div><script defer="defer" src="https://consod.github.io/connysoderholm.com/assets/js/scripts.min.js?v=01200278524b74ccf3210b7882b81e59"></script><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script>var images = document.querySelectorAll('img[loading]');
      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
            images[i].classList.add('is-loaded');
            images[i].parentNode.classList.remove('is-img-loading');
            images[i].parentNode.parentNode.classList.remove('is-img-loading');
         } else {
            images[i].addEventListener('load', function () {
               this.classList.add('is-loaded');
               this.parentNode.classList.remove('is-img-loading');
               this.parentNode.parentNode.classList.remove('is-img-loading');
            }, false);
         }
      }</script></body></html>