<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Searching for text in PDF files with pypdf2 - connysoderholm.com</title><meta name="description" content="Searching for text in PDF files with pypdf2 Portable Document Format (PDF) is wonderful as long as you do just have to read the format, not work with it. The pdf format is not really meant to be tampered with, so that is why pdf editing is normally a hard thing to do. It is defacto a worldwide standard so you will most likely come across it when coding. Read along to see how to tackle the PDF format and how to do a search to find the information contained within them."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://consod.github.io/connysoderholm.com/searching-for-text-in-pdf-files-with-pypdf2/"><link rel="alternate" type="application/atom+xml" href="https://consod.github.io/connysoderholm.com/feed.xml"><link rel="alternate" type="application/json" href="https://consod.github.io/connysoderholm.com/feed.json"><meta property="og:title" content="Searching for text in PDF files with pypdf2"><meta property="og:site_name" content="connysoderholm.com"><meta property="og:description" content="Searching for text in PDF files with pypdf2 Portable Document Format (PDF) is wonderful as long as you do just have to read the format, not work with it. The pdf format is not really meant to be tampered with, so that is why pdf editing is normally a hard thing to do. It is defacto a worldwide standard so you will most likely come across it when coding. Read along to see how to tackle the PDF format and how to do a search to find the information contained within them."><meta property="og:url" content="https://consod.github.io/connysoderholm.com/searching-for-text-in-pdf-files-with-pypdf2/"><meta property="og:type" content="article"><link rel="stylesheet" href="https://consod.github.io/connysoderholm.com/assets/css/style.css?v=7481e241a067a533a35b659302b5203e"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://consod.github.io/connysoderholm.com/searching-for-text-in-pdf-files-with-pypdf2/"},"headline":"Searching for text in PDF files with pypdf2","datePublished":"2018-06-29T22:28","dateModified":"2023-05-03T21:57","description":"Searching for text in PDF files with pypdf2 Portable Document Format (PDF) is wonderful as long as you do just have to read the format, not work with it. The pdf format is not really meant to be tampered with, so that is why pdf editing is normally a hard thing to do. It is defacto a worldwide standard so you will most likely come across it when coding. Read along to see how to tackle the PDF format and how to do a search to find the information contained within them.","author":{"@type":"Person","name":"Conny Söderholm","url":"https://consod.github.io/connysoderholm.com/authors/conny-soederholm/"},"publisher":{"@type":"Organization","name":"Conny Söderholm"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body><div class="site-container"><header class="top" id="js-header"><div class="top__inner" id="js-post__progress"><a class="logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a></div></header><main class="main"><article class="post post--sidebar-left"><header class="post__header"><h1 class="post__title">Searching for text in PDF files with pypdf2</h1><div class="metadata"><a href="https://consod.github.io/connysoderholm.com/tags/pdf/" class="metadata__maintag">pdf</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-29T22:28" class="metadata__date">29.06.2018</time><div class="metadata__update">(Updated on <time datetime="2023-05-03T21:57">03.05.2023 </time>)</div></div></header><div class="post__entry"><h1><strong><em>Searching for text in PDF files with pypdf2</em> </strong></h1><p>Portable Document Format (PDF) is wonderful as long as you do just have to read the format, not work with it. The pdf format is not really meant to be tampered with, so that is why pdf editing is normally a hard thing to do. It is defacto a worldwide standard so you will most likely come across it when coding. Read along to see how to tackle the PDF format and how to do a search to find the information contained within them.</p><p>The code below is taken from Al Sweigart's book page <a href="https://automatetheboringstuff.com/chapter13/">Automate the Boring Stuff with Python</a> (No affiliation, it is a great book that you can read for free. I do have the hard copy at home also.) I have added some error handling functionality to his code with utf-8 encoding and the strict=False for the PdfReadError.</p><p>In an earlier <a href="https://connysoderholm.com/search-files-on-your-computer-faster-with-python/">post</a>, we covered how to search for files on your hard drive. We are now going to search inside pdf files instead. for this we need the pypdf2 package which you can install from your command line; <em>py -m pip install pypdf2</em></p><p class="a-spacing-none">I used the pdf document <a href="https://www.trafi.fi/filebank/a/1477641190/49e5c4fcfde337028da9f4487ba670c2/22897-WNRB_research_report_93.pdf">SHIP-ICE INTERACTION IN A CHANNEL</a> found from <a href="https://www.trafi.fi">trafi.fi</a> as an example. According to my pdf reader, the word "ship" is written 83 times. Let's see if we can come to the same number with pypdf2. The code works as follows: first, we open the pdf and read the pdf with the PdfFileReader method.</p><p>We loop through the pages and get each page with the getPage method. The count for the word "ship" is 82, so we do not find all of the words. The word "ice" should appear 158 times, but pypdf2 only finds "ice" 153 times. This is expected behavior, since there may be tables and similar formats that pypdf2 does not detect.</p><p>We can conclude that the search is still working sufficiently good. Searching through a couple of hundred pdf's would yield good enough results if you are searching for something specific. Do you have a better way to search? Please let me know in the comments. Happy coding!</p><h2>The Code:</h2><pre class="EnlighterJSRAW" data-enlighter-language="python"># If you get the PdfReadError: Multiple definitions in dictionary at byte, add strict = False<restore-line-break>pdfReader = PyPDF2.PdfFileReader(pdfFileObj, strict=False)<restore-line-break></restore-line-break></restore-line-break></pre><pre class="EnlighterJSRAW" data-enlighter-language="null"># if you get the UnicodeEncodeError: 'charmap' codec can't encode characters, add .encode("utf-8") to your text<restore-line-break>text = pageObj.extractText().encode('utf-8')</restore-line-break></pre><pre class="EnlighterJSRAW" data-enlighter-language="python">import PyPDF2<restore-line-break>pdfFileObj = open('22897-WNRB_research_report_93.pdf', 'rb')<restore-line-break>pdfReader = PyPDF2.PdfFileReader(pdfFileObj, strict=False)<restore-line-break><restore-line-break>search_word = "ship"<restore-line-break>search_word_count = 0<restore-line-break><restore-line-break>for pageNum in range(0, pdfReader.numPages):<restore-line-break>    pageObj = pdfReader.getPage(pageNum)<restore-line-break>    text = pageObj.extractText().encode('utf-8')<restore-line-break>    search_text = text.lower().split()<restore-line-break>    for word in search_text:<restore-line-break>        if search_word in word.decode("utf-8"):<restore-line-break>            search_word_count += 1<restore-line-break>        <restore-line-break>print("The word {} was found {} times".format(search_word, search_word_count))</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></pre></div><aside class="post__sidebar post__sidebar--left"><div class="sidebar sidebar--sticky"><section class="sidebar__item"><h3 class="sidebar__title">Share on:</h3><div class="post__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsearching-for-text-in-pdf-files-with-pypdf2%2F" class="js-share facebook" title="Share with Facebook" rel="nofollow noopener noreferrer">Facebook </a><a href="https://twitter.com/share?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsearching-for-text-in-pdf-files-with-pypdf2%2F&amp;via=connysoderholm.com&amp;text=Searching%20for%20text%20in%20PDF%20files%20with%20pypdf2" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer">Twitter </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsearching-for-text-in-pdf-files-with-pypdf2%2F&amp;media=undefined&amp;description=Searching%20for%20text%20in%20PDF%20files%20with%20pypdf2" class="js-share pinterest" title="Share with Pinterest" rel="nofollow noopener noreferrer">Pinterest </a><a href="https://mix.com/add?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsearching-for-text-in-pdf-files-with-pypdf2%2F" class="js-share mix" title="Share with Mix" rel="nofollow noopener noreferrer">Mix </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsearching-for-text-in-pdf-files-with-pypdf2%2F" class="js-share linkedin" title="Share with LinkedIn" rel="nofollow noopener noreferrer">LinkedIn </a><a href="https://buffer.com/add?text=Searching%20for%20text%20in%20PDF%20files%20with%20pypdf2&amp;url=https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsearching-for-text-in-pdf-files-with-pypdf2%2F" class="js-share buffer" title="Share with Buffer" rel="nofollow noopener noreferrer">Buffer </a><a href="https://api.whatsapp.com/send?text=Searching%20for%20text%20in%20PDF%20files%20with%20pypdf2 https%3A%2F%2Fconsod.github.io%2Fconnysoderholm.com%2Fsearching-for-text-in-pdf-files-with-pypdf2%2F" class="js-share whatsapp" rel="nofollow noopener noreferrer">WhatsApp</a></div></section><section class="sidebar__item"><h3 class="sidebar__title">Tagged in:</h3><div class="post__tag"><ul><li><a href="https://consod.github.io/connysoderholm.com/tags/pdf/" title="pdf">pdf</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/pypdf2/" title="pypdf2">pypdf2</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/python/" title="Python">Python</a></li><li><a href="https://consod.github.io/connysoderholm.com/tags/search/" title="search">search</a></li></ul></div></section><nav class="sidebar__item post__nav"><div class="post__nav__prev"><h3 class="sidebar__title">Previous post:</h3><a href="https://consod.github.io/connysoderholm.com/how-to-search-for-files-on-your-computer-faster-with-python/" rel="next">How to search for files on your computer faster with Python</a></div><div class="post__nav__next"><h3 class="sidebar__title">Next post:</h3><a href="https://consod.github.io/connysoderholm.com/cruise-ship-data-visualization-with-power-bi/" rel="next">Cruise Ship Data Visualization with Power BI</a></div></nav></div></aside><footer class="post__footer"><div class="post__author"><div><h3 class="h6"><a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" rel="author">Conny Söderholm</a></h3></div></div></footer></article><div class="post__related"><h3>Related post</h3><div class="l-grid"><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/playing-super-mario-theme-music-with-python/">Playing Super Mario theme music with Python</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/beep/" class="metadata__maintag">Beep</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-27T23:54" class="metadata__date">27.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/how-to-read-folder-file-contents-into-a-text-file-with-python/">How to read folder file contents into a text file with Python</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/getcwd/" class="metadata__maintag">getcwd</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-25T23:36" class="metadata__date">25.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/create-folders-from-a-text-file-line-by-line-with-python/">Create folders from a text file, line by line with Python</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/folder/" class="metadata__maintag">folder</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-23T15:14" class="metadata__date">23.06.2018</time></div></div></article><article class="c-card c-card--compact"><div class="c-card__body"><header><h2 class="c-card__title c-card__title--compact"><a href="https://consod.github.io/connysoderholm.com/printing-dates-in-python-with-the-datetime-module/">Printing dates in Python with the datetime module</a></h2></header><div class="metadata c-card__metadata c-card__metadata--compact"><a href="https://consod.github.io/connysoderholm.com/tags/datetime/" class="metadata__maintag">datetime</a> <a href="https://consod.github.io/connysoderholm.com/authors/conny-soederholm/" class="metadata__author">Conny Söderholm</a> <time datetime="2018-06-20T19:44" class="metadata__date">20.06.2018</time></div></div></article></div></div></main><footer class="footer"><div class="footer__top"><a class="logo footer__logo" href="https://consod.github.io/connysoderholm.com/">connysoderholm.com</a></div><div class="footer__bottom"><div class="footer__copyright"></div></div></footer></div><script defer="defer" src="https://consod.github.io/connysoderholm.com/assets/js/scripts.min.js?v=01200278524b74ccf3210b7882b81e59"></script><script>window.publiiThemeMenuConfig = { mobileMenuMode: 'sidebar', animationSpeed: 300, submenuWidth: 'auto', doubleClickTime: 500, mobileMenuExpandableSubmenus: true, relatedContainerForOverlayMenuSelector: '.navbar', };</script><script>var images = document.querySelectorAll('img[loading]');
      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
            images[i].classList.add('is-loaded');
            images[i].parentNode.classList.remove('is-img-loading');
            images[i].parentNode.parentNode.classList.remove('is-img-loading');
         } else {
            images[i].addEventListener('load', function () {
               this.classList.add('is-loaded');
               this.parentNode.classList.remove('is-img-loading');
               this.parentNode.parentNode.classList.remove('is-img-loading');
            }, false);
         }
      }</script></body></html>